# 项目：求解正负电荷构成的泊松方程 - 实验报告

**学生姓名：** [李尚金] **学号：** [20231050208] **完成日期：** [2025.6.18]

## 1. 实验目的

学习使用松弛迭代法求解二维泊松方程，理解有限差分法在椭圆型偏微分方程数值求解中的应用。

## 2. 核心算法

### 2.1 算法思路

使用有限差分法将泊松方程 $\nabla^2 \phi = -\rho/\varepsilon_0$ 离散化，然后通过松弛迭代法求解线性方程组。核心迭代公式为：

$$\phi_{i,j} = \frac{1}{4}(\phi_{i+1,j} + \phi_{i-1,j} + \phi_{i,j+1} + \phi_{i,j-1} + h^2\rho_{i,j})$$

### 2.2 关键代码片段

```python
# 主迭代循环
while delta > target and iterations < max_iterations:
    # 更新内部网格点
    phi[1:-1, 1:-1] = 0.25 * (phi[0:-2, 1:-1] + phi[2:, 1:-1] + 
                               phi[1:-1, :-2] + phi[1:-1, 2:] + 
                               h*h * rho[1:-1, 1:-1])
    
    # 计算收敛判据
    delta = np.max(np.abs(phi - phi_prev))
    phi_prev = np.copy(phi)
    iterations += 1
```

## 3. 实验结果

### 3.1 主要输出

 Iterations: 9219
  Converged: True
  Max potential: 100.296518 V
  Min potential: -100.296518 V
  Potential range: 200.593036 V
  Max potential location: (70, 30)
  Min potential location: (30, 70)
### 3.2 电势分布图

[在此插入电势分布的可视化图像]
![image](https://github.com/user-attachments/assets/a0885e52-45eb-4d5c-836a-f04a50f37c80)

问题与收获
 
4.1 主要问题
 
1. 收敛速度问题： 初始时迭代收敛较慢，尤其是在网格点数较多时，需要大量的迭代次数才能达到收敛条件，导致计算时间过长。
2. 边界条件处理： 在每次迭代过程中，需要确保边界条件不被破坏，而在更新内部网格点时容易忽略边界条件的维护，导致最终结果不符合物理预期。
 
4.2 解决方法
 
1. 优化迭代： 使用适当的松弛因子可以加速收敛。在后续实验中可以尝试引入SOR（逐次超松弛）方法，通过调整松弛因子，加快迭代过程中电势值的更新速度，减少达到收敛所需的迭代次数。
2. 数组操作： 利用NumPy的数组切片功能高效更新内部网格点，同时在每次迭代前后，明确边界条件，直接将边界网格点的电势值设置为规定的边界值，保证边界条件始终满足。
 
4.3 主要收获
 
通过本实验，深入理解了有限差分法的基本原理，掌握了松弛迭代法求解椭圆型偏微分方程的方法，学会了使用Python进行科学计算和可视化。同时，也提升了将物理问题转化为数值计算问题，并对计算结果进行物理分析和验证的能力，对静电场中的电势分布有了更直观的认识。
 
5. 思考题
 
5.1 网格密度的影响
 
问题： 增加网格密度对解的精度和计算时间有什么影响？
 
回答： 增加网格密度意味着网格间距   变小，离散化后的网格点数量增多，能够更精细地描述空间中电势的变化情况，从而提高解的精度，可以捕捉到更细微的电势分布特征。然而，随着网格密度增加，每次迭代需要更新的网格点数量增多，计算量呈指数级增长，导致计算时间显著增加 。并且，当网格密度过大时，还可能会引入数值误差，影响计算结果的准确性。
 
5.2 收敛判据的选择
 
问题： 不同的收敛精度设置如何影响最终结果？
 
回答： 收敛精度设置得过松，即允许的前后两次迭代电势差的最大值较大，迭代过程会较快结束，但可能未达到真正的稳定解，得到的电势分布与真实解存在较大偏差，结果精度较低。而将收敛精度设置得过紧，虽然能得到更接近真实解的结果，提高解的准确性，但会大幅增加迭代次数，延长计算时间，甚至在计算资源有限的情况下，可能因长时间无法达到收敛条件而导致计算失败 。
 
5.3 物理意义
 
问题： 从物理角度解释为什么正负电荷之间会形成这样的电势分布？
 
回答： 在静电场中，电势是描述电场能性质的物理量。正电荷是电场线的源头，负电荷是电场线的汇点，电场线方向从正电荷指向负电荷。沿着电场线方向，电势逐渐降低，因此正电荷附近电势较高，负电荷附近电势较低。在正负电荷之间，由于电场线的分布，电势从正电荷处的高电势逐渐降低到负电荷处的低电势，形成了连续变化的电势分布。同时，根据泊松方程，电荷分布决定了电势的空间变化情况，正负电荷的存在导致了周围空间电势的相应改变，最终形成了这样的电势分布。

## 6. 代码改进建议

1. **性能优化：** 可以考虑使用SOR（逐次超松弛）方法加速收敛
2. **可视化增强：** 添加等势线图和电场矢量图
3. **参数化设计：** 使电荷位置和强度可配置

## 7. 参考资料

1. 计算物理学教材相关章节
2. NumPy和Matplotlib官方文档
3. 数值分析相关资料
